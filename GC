using UnityEngine;

public class GameController : MonoBehaviour
{
    public static GameController Instance;

    public bool IsOk { get; private set; } = false;
    private int totalTargets;
    private int destroyedTargets;

    private void Awake()
    {
        if (Instance == null)
            Instance = this;
        else
            Destroy(gameObject);
    }

    private void Start()
    {
        PauseGameplay();
    }

    public void StartGameplay(int targetCount)
    {
        totalTargets = targetCount;
        destroyedTargets = 0;

        ResumeGameplay();
        Time.timeScale = 1f;

        Debug.Log("Game started with " + totalTargets + " targets.");
    }

    public void TargetDestroyed()
    {
        destroyedTargets++;
        Debug.Log($"Target destroyed! {destroyedTargets}/{totalTargets}");

        if (destroyedTargets >= totalTargets)
        {
            Debug.Log("All targets destroyed! Player can now move up/down stairs.");
        }
    }

    public void PauseGameplay()
    {
        IsOk = false;
        Time.timeScale = 0f;
        Debug.Log("Game paused.");
    }

    public void ResumeGameplay()
    {
        IsOk = true;
        Time.timeScale = 1f;
        Debug.Log("Game resumed.");
    }

    public void FinalPlatformReached()
    {
        Debug.Log("Level complete!");
        PauseGameplay();
    }
}